{
  "name": "linux-pre-docker",
  "chef_type": "role",
  "json_class": "Chef::Role",
  "description": "",
  "default_attributes": {
    "debug_logger": "linux-pre-docker",
    "files": [
    ],
    "package": [
      {
        "name": "device-mapper-persistent-data"
      },
      {
        "name": "lvm2"
      }
    ],
    "execute": [
      {
        "command": "curl -sL https://download.docker.com/linux/centos/docker-ce.repo >/etc/yum.repos.d/docker-ce.repo",
        "description": "Add docker repo"
      },
      {
        "command": "curl -sL https://download.opensuse.org/repositories/devel:kubic:libcontainers:stable/CentOS_7/devel:kubic:libcontainers:stable.repo >/etc/yum.repos.d/kubic-stable.repo",
        "description": "Add buildah and podman repo"
      },
      {
        "command": "setenforce 0",
        "description": "Disable SE Linux"
      },
      {
        "command": "sed -i 's/^SELINUX=enforcing$/SELINUX=permissive/' /etc/selinux/config",
        "description": "Disable SE Linux permanently"
      },
      {
        "command": "echo https://releases.hashicorp.com/terraform/$(curl -sL https://checkpoint-api.hashicorp.com/v1/check/terraform | jq -r -M '.current_version')/terraform_$(curl -sL https://checkpoint-api.hashicorp.com/v1/check/terraform | jq -r -M '.current_version')_linux_amd64.zip >/tmp/url_tf_latest",
        "description": "Get latest terraform url -> /tmp/url_*_latest"
      },
      {
        "command": "curl -sL $(cat /tmp/url_tf_latest) >/tmp/terraform.zip && unzip -qq -o /tmp/terraform.zip -d /usr/local/bin/terraform && chmod a+x /usr/local/bin/terraform",
        "description": "Install latest terraform"
      },
      {
        "command": "echo https://github.com/terraform-linters/tflint/releases/latest/download/tflint_linux_amd64.zip >/tmp/url_tflint_latest",
        "description": "Get latest terraform lint url -> /tmp/url_*_latest"
      },
      {
        "command": "curl -sL $(cat /tmp/url_tflint_latest) >/tmp/tflint.zip && unzip -qq -o /tmp/tflint.zip -d /usr/local/bin/tflint && chmod a+x /usr/local/bin/tflint",
        "description": "Install latest terraform lint"
      },
      {
        "command": "echo https://releases.hashicorp.com/vault/1.3.4/vault_1.3.4_linux_amd64.zip >/tmp/url_vault_latest",
        "description": "Get latest vault url -> /tmp/url_*_latest"
      },
      {
        "command": "curl -sL $(cat /tmp/url_vault_latest) >/tmp/vault.zip && unzip -qq -o /tmp/vault.zip -d /usr/local/bin/vault && chmod a+x /usr/local/bin/vault",
        "description": "Install latest vault"
      }
    ]
  },
  "override_attributes": {},
  "run_list": [
    "recipe[linux::files]",
    "recipe[linux::exec]",
    "recipe[linux::packages]"
  ]
}
